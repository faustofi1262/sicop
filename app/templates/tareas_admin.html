
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Gesti√≥n de Tareas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        fieldset { border-radius: 8px; }
        legend { font-size: 1.1rem; }
    </style>
    <script>
        function mostrarDatos() {
            const select = document.getElementById("requerimiento_id");
            const unidad = select.options[select.selectedIndex].getAttribute("data-unidad");
            const funcionario = select.options[select.selectedIndex].getAttribute("data-funcionario");

            document.getElementById("unidad").value = unidad;
            document.getElementById("funcionario_encargado").value = funcionario;

            document.getElementById("bloque_tarea").disabled = (select.value === "");
        }
    </script>
</head>
<body class="container py-4">
    <h2 class="text-primary mb-4">Gesti√≥n de Tareas del Proceso de Contrataci√≥n</h2>

    <form method="POST">
        <!-- Selecci√≥n del Requerimiento -->
        <fieldset class="border p-3 mb-4">
            <legend class="w-auto text-primary font-weight-bold">üìë Requerimiento Vinculado</legend>
            <div class="form-row">
                <div class="col-md-6">
                    <label>Seleccione el N¬∞ de Oficio (memo_vice_ad):</label>
                    <select name="requerimiento_id" id="requerimiento_id" class="form-control form-control-sm" onchange="mostrarDatos()" required>
                        <option value="">-- Seleccione un memo --</option>
                        {% for r in requerimientos %}
                            <option value="{{ r[0] }}" data-unidad="{{ r[2] }}" data-funcionario="{{ r[3] }}">{{ r[1] }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col-md-3">
                    <label>Unidad Requirente:</label>
                    <input type="text" id="unidad" class="form-control form-control-sm" disabled>
                </div>
                <div class="col-md-3">
                    <label>Funcionario Encargado:</label>
                    <input type="text" id="funcionario_encargado" name="funcionario_encargado" class="form-control form-control-sm" readonly>
                </div>
            </div>
        </fieldset>

        <!-- Formulario Tareas -->
        <fieldset id="bloque_tarea" class="border p-3" disabled>
            <legend class="w-auto text-primary font-weight-bold">üìù Informaci√≥n del Proceso</legend>

            <div class="form-row">
                <div class="col">
                    <label>Tipo de Proceso:</label>
                    <input type="text" name="tipo_proceso" class="form-control form-control-sm" required>
                </div>
                <div class="col">
                    <label>Estado del Requerimiento:</label>
                    <input type="text" name="estado_requerimiento" class="form-control form-control-sm">
                </div>
            </div>

            <label class="mt-2">Objeto de la Contrataci√≥n:</label>
            <textarea name="objeto_contratacion" class="form-control" rows="2"></textarea>

            <div class="form-row mt-2">
                <div class="col">
                    <label>C√≥digo del Proceso:</label>
                    <input type="text" name="codigo_proceso" class="form-control form-control-sm">
                </div>
                <div class="col">
                    <label>Fecha de Recepci√≥n:</label>
                    <input type="date" name="fecha_recepcion" class="form-control form-control-sm">
                </div>
            </div>

            <div class="form-row mt-2">
                <div class="col">
                    <label>Valor sin IVA:</label>
                    <input type="number" name="valor_sin_iva" step="0.01" class="form-control form-control-sm">
                </div>
                <div class="col">
                    <label>Valor Exento:</label>
                    <input type="number" name="valor_exento" step="0.01" class="form-control form-control-sm">
                </div>
            </div>

            <label class="mt-2">Valor en Letras:</label>
            <input type="text" name="valor_en_letras" class="form-control form-control-sm">

            <label class="mt-2">Tipo de Proceso a Aplicar:</label>
            <input type="text" name="tipo_proceso_aplicar" class="form-control form-control-sm">

            <label class="mt-2">Base Legal:</label>
            <input type="text" name="base_legal" class="form-control form-control-sm">

            <label class="mt-2">Observaciones:</label>
            <textarea name="observaciones" class="form-control" rows="2"></textarea>

            <div class="form-row mt-2">
                <div class="col">
                    <label>Fecha Env√≠o Observaciones:</label>
                    <input type="date" name="fecha_envio_observaciones" class="form-control form-control-sm">
                </div>
                <div class="col">
                    <label>Fecha Correcci√≥n Observaciones:</label>
                    <input type="date" name="fecha_correccion_observacion" class="form-control form-control-sm">
                </div>
            </div>

            <label class="mt-2">Nombre del Jefe de Compras:</label>
            <input type="text" name="nombre_jefe_compras" class="form-control form-control-sm">

            <label class="mt-2">Unidad Solicitante:</label>
            <input type="text" name="unidad_solicitante" class="form-control form-control-sm">

            <label class="mt-2">Administrador del Contrato:</label>
            <input type="text" name="administrador_contrato" class="form-control form-control-sm">

            <h5 class="mt-4 text-primary font-weight-bold">‚úÖ Verificaci√≥n de Documentos</h5>
            <div class="form-row">
                <div class="col-md-4">
                    <div class="form-check"><input class="form-check-input" type="checkbox" name="presenta_estudio_previo"> Estudio Previo</div>
                    <div class="form-check"><input class="form-check-input" type="checkbox" name="presenta_terminos_referencia"> T√©rminos de Referencia</div>
                    <div class="form-check"><input class="form-check-input" type="checkbox" name="presenta_estudio_mercado"> Estudio de Mercado</div>
                    <div class="form-check"><input class="form-check-input" type="checkbox" name="consta_catalogo_electronico"> En Cat√°logo Electr√≥nico</div>
                    <div class="form-check"><input class="form-check-input" type="checkbox" name="consta_pac"> En el PAC</div>
                </div>
                <div class="col-md-4">
                    <div class="form-check"><input class="form-check-input" type="checkbox" name="presenta_especificaciones"> Especificaciones T√©cnicas</div>
                    <div class="form-check"><input class="form-check-input" type="checkbox" name="presenta_proformas"> Presenta Proformas</div>
                    <div class="form-check"><input class="form-check-input" type="checkbox" name="determinacion_necesidad"> Determinaci√≥n de la Necesidad</div>
                    <div class="form-check"><input class="form-check-input" type="checkbox" name="catalogado_incluido_gne"> Catalogado Incluido GNE</div>
                </div>
                <div class="col-md-4">
                    <div class="form-check"><input class="form-check-input" type="checkbox" name="presenta_errores"> Presenta Errores</div>
                    <div class="form-check"><input class="form-check-input" type="checkbox" name="cumple_normativa"> Cumple Normativa</div>
                </div>
            </div>

            <button type="submit" class="btn btn-primary mt-4">Guardar Tarea</button>
        </fieldset>
    </form>
</body>
</html>
